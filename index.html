<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>DarkSky.net JavaScript Wrapper</title>
	<meta name="description" content="">
	<meta name="keywords" content="" />
	<meta name="author" content="">
  <style>
    body {
      margin: 0 auto;
      max-width: 600px;
      font-family: sans-serif;
    }
  </style>
</head>

<body>
	<h1>Forecast.io JS API</h1>
  <p>The examples below are the product of a request
    that takes two locations (Berlin and Abalessa) that are
    given in Lat Long coordinates.
  </p>
  <p>Temperature is expressed in Fahrenheit</p>
	<h2>Current Temperatures</h2>
	<div id="currentTemp">
    <p>Loading...</p>
  </div>

	<hr>

	<h2>Forecast for today</h2>
	<div id="itemList">
    <p>Loading...</p>
  </div>

	<hr>

	<h2>Forecast for the week</h2>
	<div id="itemList2">
    <p>Loading...</p>
  </div>

	<script src="require.js"></script>
<!--	<script src="forecast.io.js"</script> -->
	<script>
	var DarkSky = require(['darksky.net'], function(DarkSky) {
	    //This function is called when scripts/helper/util.js is loaded.
	    //If util.js calls define(), then this function is not fired until
	    //util's dependencies have loaded, and the util argument will hold
	    //the module value for 'helper/util'.

	    /*
		 * EXAMPLE LOCATION DATA
		 */
		var locations = [
			{
        name: 'Berlin',
				latitude: '52.4308',
				longitude: '13.2588'
			},
			{
        name: 'Abalessa',
        latitude: '22.4308',
				longitude: '3.2588'
			}
		];
		// Single Object Example
		// var locations = {
		// 	latitude: '52.4308',
		// 	longitude: '13.2588'
		// };

		var forecast = new DarkSky({
			PROXY_SCRIPT: 'proxy.php'
		});

		/*
		 * GET CURRENT CONDITIONS
		 */
		forecast.getCurrentConditions(locations, function(locsConditions) {
      var items = '';
      for (var i = 0; i < locsConditions.length; i++) {
        var locConditions = locsConditions[i];
        items += '<p>' + locations[i].name + '</p>';
        console.log('locConditions', locConditions);
        //Call desired fns
        items += '<p>' + locConditions.temperature() + '</p>';
      }
			document.getElementById('currentTemp').innerHTML = items;
		});

		/*
		 * GET HOURLY CONDITIONS FOR TODAY
		 */
		forecast.getForecastToday(locations, function(conditions) {
			// var items = '';
      // console.log('getForecastToday conditions', conditions);
			// for (var i = 0; i < conditions.length; i++) {
      //   //items += '<p>' + locations[i].name + '</p>';
			// 	items += '<p>' + conditions[i].time('HH:mm') + ': temperature ' + conditions[i].temperature() + '</p>';
			// }
      //
			// document.getElementById('itemList').innerHTML = items;
		});

		/*
		 * GET DAILY CONDITIONS FOR NEXT 7 DAYS
		 */
		forecast.getForecastWeek(locations, function(conditions) {
			// var items = '';
			// for (var i = 0; i < conditions.length; i++) {
      //   items += '<p>' + locations[i].name + '</p>';
			// 	conditions[i].forEach(function(daily) {
      //     items += '<p>' + daily[i].time('YYYY-MM-DD') + ': ' + daily[i].temperatureMax() + '</p>';
      //   });
			// }
      //
			// document.getElementById('itemList2').innerHTML = items;
		});
	});

	</script>
</body>
</html>
